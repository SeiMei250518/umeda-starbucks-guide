<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>æ¢…ç”°ã‚¹ã‚¿ãƒå®Œå…¨æ”»ç•¥ã‚¬ã‚¤ãƒ‰ 2025</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+JP:wght@400;500;700&display=swap" rel="stylesheet">
    <style>
        body { font-family: 'Noto Sans JP', sans-serif; background-color: #f3f7f4; color: #1e3932; }
        .sb-green { background-color: #00704A; }
        .sb-dark { background-color: #1e3932; }
        #map { height: 40vh; width: 100%; border-bottom: 4px solid #00704A; }
        .card { transition: all 0.2s ease-in-out; }
        .card:hover { transform: translateY(-4px); box-shadow: 0 12px 20px rgba(0,0,0,0.1); }
        .badge { font-size: 10px; font-weight: bold; padding: 2px 8px; border-radius: 9999px; text-transform: uppercase; }
        .badge-reserve { background-color: #000; color: #c4a163; border: 1px solid #c4a163; }
        .badge-tea { background-color: #ffb7c5; color: #d00050; }
        .badge-new { background-color: #ff3d00; color: #fff; }
        .sticky-nav { position: sticky; top: 0; z-index: 1000; background: rgba(255,255,255,0.98); backdrop-filter: blur(10px); }
        .no-scrollbar::-webkit-scrollbar { display: none; }
        .btn-active { background-color: #00704A !important; color: white !important; border-color: #00704A !important; }
    </style>
</head>
<body>

<header class="sb-dark text-white py-3 px-4 shadow-md text-center">
    <h1 class="text-xl font-bold tracking-tighter">â˜• æ¢…ç”°ã‚¹ã‚¿ãƒå®Œå…¨æ”»ç•¥ã‚¬ã‚¤ãƒ‰ 2025</h1>
</header>

<div id="map"></div>

<div class="sticky-nav border-b shadow-md">
    <div class="container mx-auto px-4 py-3">
        <!-- Search Bar -->
        <div class="relative mb-3">
            <input type="text" id="searchInput" placeholder="åº—åã€ã‚¨ãƒªã‚¢ã€ç‰¹å¾´ï¼ˆç©´å ´ã€é›»æºã€æœæ´»...ï¼‰ã§æ¤œç´¢" 
                   class="w-full p-3 pl-10 bg-gray-50 border border-gray-300 rounded-xl focus:outline-none focus:ring-2 focus:ring-[#00704A] text-sm">
            <span class="absolute left-3 top-3.5 opacity-40">ğŸ”</span>
        </div>
        
        <!-- Category Filters -->
        <div class="flex overflow-x-auto gap-2 pb-2 no-scrollbar text-[11px] font-bold">
            <button class="cat-btn border border-gray-300 px-4 py-1.5 rounded-full whitespace-nowrap bg-white" data-cat="all">ã™ã¹ã¦</button>
            <button class="cat-btn border border-gray-300 px-4 py-1.5 rounded-full whitespace-nowrap bg-white text-blue-700 border-blue-200" data-cat="power">ğŸ”Œ é›»æºã‚ã‚Š</button>
            <button class="cat-btn border border-gray-300 px-4 py-1.5 rounded-full whitespace-nowrap bg-white text-indigo-700 border-indigo-200" data-cat="work">ğŸ“š èª­æ›¸ãƒ»ä»•äº‹</button>
            <button class="cat-btn border border-gray-300 px-4 py-1.5 rounded-full whitespace-nowrap bg-white text-orange-700 border-orange-200" data-cat="night">ğŸŒ™ 23æ™‚ã¾ã§</button>
            <button class="cat-btn border border-gray-300 px-4 py-1.5 rounded-full whitespace-nowrap bg-white text-pink-600 border-pink-200" data-cat="tea">ğŸŒ¸ ç´…èŒ¶ç‰¹åŒ–</button>
            <button class="cat-btn border border-gray-300 px-4 py-1.5 rounded-full whitespace-nowrap bg-white text-yellow-700 border-yellow-300" data-cat="reserve">â­ ãƒªã‚¶ãƒ¼ãƒ–</button>
            <button class="cat-btn border border-gray-300 px-4 py-1.5 rounded-full whitespace-nowrap bg-white text-red-600 border-red-200" data-cat="new">ğŸ†• 2024-25æ–°åº—</button>
        </div>
    </div>
</div>

<main class="container mx-auto px-4 py-6">
    <div id="resultInfo" class="text-xs font-bold text-gray-500 mb-4 ml-1">34åº—èˆ—ã‚’è¡¨ç¤ºä¸­</div>
    <div id="storeGrid" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-3 gap-6">
        <!-- JS Inserted -->
    </div>
</main>

<script>
// ===================================================================
// å…¨34åº—èˆ— æœ€çµ‚æ¤œè¨¼æ¸ˆã¿ãƒ‡ãƒ¼ã‚¿ãƒ™ãƒ¼ã‚¹
// ãƒ¦ãƒ¼ã‚¶ãƒ¼æä¾›ã®ç·¯åº¦çµŒåº¦ãƒ»è©³ç´°ãƒ‡ãƒ¼ã‚¿ã‚’å®Œå…¨åæ˜ 
// ===================================================================
const stores = [
    { id: "SBUX-001", name: "LUCUA osaka åœ°ä¸‹2éšåº—", facility: "LUCUA osaka", floor: "B2F", hours: "11:00ã€œ23:00", lat: 34.7029954, lng: 135.4952921, reserve: true, tea: false, power: true, night: true, new: false, work: true, scene: "ç‰¹åˆ¥ãªã‚³ãƒ¼ãƒ’ãƒ¼ä½“é¨“ãƒ»ãƒ‡ãƒ¼ãƒˆ", note: "ReserveÂ® Barã€‚ã‚µã‚¤ãƒ•ã‚©ãƒ³æŠ½å‡ºå¯¾å¿œã€‚", mapUrl: "https://store.starbucks.co.jp/detail-1536/" },
    { id: "SBUX-002", name: "LUCUA 2éšåº—", facility: "LUCUA", floor: "2F", hours: "07:00ã€œ22:00", lat: 34.7032433, lng: 135.4956585, reserve: false, tea: true, power: true, night: false, new: false, work: false, scene: "ç´…èŒ¶å¥½ããƒ»ã‚·ãƒ§ãƒƒãƒ”ãƒ³ã‚°ä¼‘æ†©", note: "Tea & Cafeåº—ã€‚TEAVANAãƒ¡ãƒ‹ãƒ¥ãƒ¼å……å®Ÿã€‚", mapUrl: "https://store.starbucks.co.jp/detail-4093/" },
    { id: "SBUX-003", name: "LUCUA 1100 2F ã‚¢ãƒˆãƒªã‚¦ãƒ ã‚¬ãƒ¼ãƒ‡ãƒ³åº—", facility: "LUCUA 1100", floor: "2F", hours: "07:00ã€œ22:00", lat: 34.7029925, lng: 135.495372, reserve: false, tea: false, power: false, night: false, new: false, work: false, scene: "è¦³å…‰ãƒ»å†™çœŸãƒ»ä¼‘æ†©", note: "ãƒˆãƒ¼ãƒ«é™å®šã€‚é–‹æ”¾æ„ŸæŠœç¾¤ã®ã‚¢ãƒˆãƒªã‚¦ãƒ éš£æ¥ã€‚", mapUrl: "https://store.starbucks.co.jp/detail-1258/" },
    { id: "SBUX-004", name: "LUCUA 1100 2F ã‚°ãƒ©ãƒ³ãƒãƒ«ã‚·ã‚§åº—", facility: "LUCUA 1100", floor: "2F", hours: "10:30ã€œ20:30", lat: 34.70301, lng: 135.49545, reserve: false, tea: false, power: false, night: false, new: false, work: false, scene: "è²·ã„ç‰©é€”ä¸­ã®ä¼‘æ†©", note: "é£Ÿç‰©è²©ã‚¾ãƒ¼ãƒ³å†…ã€‚ãƒ†ã‚¤ã‚¯ã‚¢ã‚¦ãƒˆã«ã‚‚ä¾¿åˆ©ã€‚", mapUrl: "https://store.starbucks.co.jp/detail-1257/" },
    { id: "SBUX-005", name: "LUCUA 9éšåº—", facility: "LUCUA", floor: "9F", hours: "10:30ã€œ20:30", lat: 34.7028866, lng: 135.4953236, reserve: false, tea: false, power: true, night: false, new: false, work: false, scene: "ãƒ©ãƒ³ãƒå¾Œã®ä¼‘æ†©ãƒ»ç©´å ´", note: "æ¯”è¼ƒçš„ç©ºã„ã¦ã„ã¦è½ã¡ç€ã‘ã‚‹ç©´å ´åº—èˆ—ã€‚", mapUrl: "https://store.starbucks.co.jp/detail-977/" },
    { id: "SBUX-006", name: "æ¢…ç”° è”¦å±‹æ›¸åº—", facility: "LUCUA 1100", floor: "9F", hours: "08:30ã€œ21:00", lat: 34.7028866, lng: 135.4953236, reserve: false, tea: false, power: true, night: false, new: false, work: true, scene: "ä»•äº‹ãƒ»å‹‰å¼·ãƒ»èª­æ›¸", note: "è”¦å±‹æ›¸åº—ä½µè¨­ã€‚æœ¬ã‚’èª­ã¿ãªãŒã‚‰é•·å±…å¯èƒ½ã€‚", mapUrl: "https://store.starbucks.co.jp/detail-2069/" },
    { id: "SBUX-007", name: "JRå¤§é˜ªé§…åŒ—åº—", facility: "JRå¤§é˜ªé§…", floor: "åŒ—æ”¹æœ­å¤–", hours: "07:00ã€œ22:00", lat: 34.703132, lng: 135.496179, reserve: false, tea: false, power: true, night: false, new: false, work: false, scene: "æœæ´»ãƒ»é€šå‹¤ãƒ»å¾…ã¡åˆã‚ã›", note: "åŒ—æ”¹æœ­ã™ãã€‚åˆ©ä¾¿æ€§NO.1ã€‚", mapUrl: "https://store.starbucks.co.jp/detail-2313/" },
    { id: "SBUX-008", name: "ã‚¨ã‚­ãƒãƒ«ã‚·ã‚§å¤§é˜ªåº—", facility: "ã‚¨ã‚­ãƒãƒ«ã‚·ã‚§å¤§é˜ª", floor: "B1F", hours: "07:00ã€œ22:00", lat: 34.7015551, lng: 135.4948114, reserve: false, tea: false, power: true, night: false, new: false, work: false, scene: "æ–°å¹¹ç·šå‰ãƒ»æœæ´»", note: "æ¡œæ©‹å£ç›´çµã€‚æœ7æ™‚ã‹ã‚‰å–¶æ¥­ã€‚", mapUrl: "https://store.starbucks.co.jp/detail-1405/" },
    { id: "SBUX-009", name: "ï¼«ï¼©ï¼´ï¼´ï¼¥å¤§é˜ªåº—", facility: "KITTEå¤§é˜ª", floor: "6F", hours: "09:00ã€œ22:00", lat: 34.700615, lng: 135.494421, reserve: false, tea: false, power: true, night: false, new: true, work: true, scene: "ãƒ‡ãƒ¼ãƒˆãƒ»æœ€æ–°ã‚¹ãƒãƒƒãƒˆ", note: "2024.7é–‹æ¥­ã€‚ã†ã‚ããŸå…¬åœ’ã‚’è¦‹æ¸¡ã™çœºæœ›ã€‚", mapUrl: "https://store.starbucks.co.jp/detail-4324/" },
    { id: "SBUX-010", name: "TSUTAYA ã‚¤ãƒã‚²ãƒ¼ãƒˆå¤§é˜ªåº—", facility: "ã‚¤ãƒã‚²ãƒ¼ãƒˆå¤§é˜ª", floor: "6F", hours: "08:00ã€œ22:00", lat: 34.7020477, lng: 135.4933685, reserve: false, tea: false, power: true, night: false, new: true, work: true, scene: "ãƒãƒãƒ‰ãƒ»çœºæœ›ãƒ»èª­æ›¸", note: "2024.7é–‹æ¥­ã€‚ãƒ†ãƒ©ã‚¹ã‹ã‚‰ã®å…¬åœ’ãƒ“ãƒ¥ãƒ¼ãŒæœ€é«˜ã€‚", mapUrl: "https://store.starbucks.co.jp/detail-2261/" },
    { id: "SBUX-011", name: "ã‚°ãƒ©ãƒ³ãƒ•ãƒ­ãƒ³ãƒˆå¤§é˜ª åŒ—é¤¨1éšåº—", facility: "GFå¤§é˜ª åŒ—é¤¨", floor: "1F", hours: "07:00ã€œ22:00", lat: 34.7053655, lng: 135.4943626, reserve: false, tea: true, power: true, night: false, new: false, work: false, scene: "ç´…èŒ¶ãƒ»ãƒ†ãƒ©ã‚¹ä¼‘æ†©", note: "Tea & Cafeåº—ã€‚é–‹æ”¾çš„ãªãƒ†ãƒ©ã‚¹ãŒäººæ°—ã€‚", mapUrl: "https://store.starbucks.co.jp/detail-4155/" },
    { id: "SBUX-012", name: "ã‚°ãƒ©ãƒ³ãƒ•ãƒ­ãƒ³ãƒˆå¤§é˜ª å—é¤¨6éšåº—", facility: "GFå¤§é˜ª å—é¤¨", floor: "6F", hours: "11:00ã€œ21:00", lat: 34.7045973, lng: 135.4949254, reserve: false, tea: false, power: true, night: false, new: false, work: true, scene: "ä»•äº‹ãƒ»è½ã¡ç€ã„ãŸä¼‘æ†©", note: "å—é¤¨ã®ãƒ¬ã‚¹ãƒˆãƒ©ãƒ³ãƒ•ãƒ­ã‚¢ã€‚æ¯”è¼ƒçš„ç©ºã„ã¦ã„ã‚‹ã€‚", mapUrl: "https://store.starbucks.co.jp/detail-1113/" },
    { id: "SBUX-013", name: "ã†ã‚ããŸã‚°ãƒªãƒ¼ãƒ³ãƒ—ãƒ¬ã‚¤ã‚¹åº—", facility: "ã‚°ãƒ©ãƒ³ã‚°ãƒªãƒ¼ãƒ³", floor: "2F", hours: "07:00ã€œ22:30", lat: 34.702892, lng: 135.493261, reserve: false, tea: false, power: true, night: false, new: true, work: false, scene: "æ•£æ­©ãƒ»è¦³å…‰ãƒ»å…¬åœ’ãƒ“ãƒ¥ãƒ¼", note: "2025.3é–‹æ¥­ã€‚æœ€æ–°ã®ã‚µã‚¹ãƒ†ãƒŠãƒ–ãƒ«åº—èˆ—ã€‚", mapUrl: "https://store.starbucks.co.jp/detail-4434/" },
    { id: "SBUX-014", name: "LINKS UMEDA B1Fåº—", facility: "LINKS UMEDA", floor: "B1F", hours: "10:00ã€œ21:00", lat: 34.7047859, lng: 135.4968839, reserve: false, tea: false, power: false, night: false, new: false, work: false, scene: "çˆ†é€Ÿãƒ†ã‚¤ã‚¯ã‚¢ã‚¦ãƒˆ", note: "ãƒˆãƒ¼ãƒ«é™å®šã€‚ãƒ†ã‚¤ã‚¯ã‚¢ã‚¦ãƒˆç‰¹åŒ–å‹ã€‚", mapUrl: "https://store.starbucks.co.jp/detail-1808/" },
    { id: "SBUX-015", name: "LINKS UMEDA 2Fåº—", facility: "LINKS UMEDA", floor: "2F", hours: "10:00ã€œ21:00", lat: 34.7048595, lng: 135.4969272, reserve: false, tea: false, power: true, night: false, new: false, work: true, scene: "å¾…ã¡åˆã‚ã›ãƒ»PCä½œæ¥­", note: "2Fãƒ‡ãƒƒã‚­ç›´çµã€‚ã‚«ã‚¦ãƒ³ã‚¿ãƒ¼å¸­å¤šã‚ã€‚", mapUrl: "https://store.starbucks.co.jp/detail-1809/" },
    { id: "SBUX-016", name: "LINKS UMEDA 8Fåº—", facility: "LINKS UMEDA", floor: "8F", hours: "10:00ã€œ21:00", lat: 34.7041898, lng: 135.4962546, reserve: false, tea: false, power: true, night: false, new: false, work: true, scene: "é•·å±…ãƒ»ä»•äº‹ãƒ»ç©´å ´", note: "LINKSå†…æœ€å¤§ã€‚é›»æºå……å®Ÿã§ã‹ãªã‚Šç©´å ´ã€‚", mapUrl: "https://store.starbucks.co.jp/detail-1810/" },
    { id: "SBUX-017", name: "é˜ªæ€¥ã†ã‚ã æœ¬åº— 9éšåº—", facility: "é˜ªæ€¥ã†ã‚ã ", floor: "9F", hours: "10:00ã€œ20:00", lat: 34.7030253, lng: 135.4985514, reserve: false, tea: true, power: true, night: false, new: false, work: false, scene: "ç™¾è²¨åº—ä¼‘æ†©ãƒ»ãƒ‡ãƒ¼ãƒˆ", note: "Tea & Cafeåº—ã€‚å¤§éšæ®µæ¨ªã®å„ªé›…ãªç©ºé–“ã€‚", mapUrl: "https://store.starbucks.co.jp/detail-4249/" },
    { id: "SBUX-018", name: "é˜ªæ€¥ã‚µãƒ³åºƒå ´åœ°ä¸‹é€šã‚Šåº—", facility: "é˜ªæ€¥ã‚µãƒ³åºƒå ´", floor: "B1F", hours: "07:00ã€œ23:00", lat: 34.7033393, lng: 135.4990003, reserve: false, tea: false, power: true, night: true, new: false, work: false, scene: "çµ‚é›»å‰ãƒ»é€šå‹¤", note: "æ¢…ç”°æœ€é…ç´šã®23æ™‚ã¾ã§å–¶æ¥­ã€‚åœ°ä¸‹ã§ä¾¿åˆ©ã€‚", mapUrl: "https://store.starbucks.co.jp/detail-1848/" },
    { id: "SBUX-019", name: "é˜ªç¥æ¢…ç”°æœ¬åº— 9éšåº—", facility: "é˜ªç¥æ¢…ç”°", floor: "9F", hours: "10:00ã€œ22:00", lat: 34.7014877, lng: 135.4984146, reserve: false, tea: false, power: true, night: false, new: false, work: false, scene: "çœºæœ›ãƒ»é£Ÿäº‹å‰å¾Œ", note: "ãƒ•ãƒ¼ãƒ‰ãƒ›ãƒ¼ãƒ«å†…ã€‚çª“éš›å¸­ã®æ™¯è‰²ãŒæŠœç¾¤ã€‚", mapUrl: "https://store.starbucks.co.jp/detail-1836/" },
    { id: "SBUX-020", name: "é˜ªç¥æ¢…ç”°æœ¬åº— åœ°ä¸‹2éšåº—", facility: "é˜ªç¥æ¢…ç”°", floor: "B2F", hours: "08:00ã€œ23:00", lat: 34.701093, lng: 135.4977896, reserve: false, tea: false, power: true, night: true, new: false, work: false, scene: "å¤œã‚«ãƒ•ã‚§ãƒ»ãƒãƒ«å¸°ã‚Š", note: "23æ™‚ã¾ã§å–¶æ¥­ã€‚ãƒãƒ«æ¨ªä¸å†…ã§å¤œã‚‚è³‘ã‚„ã‹ã€‚", mapUrl: "https://store.starbucks.co.jp/detail-1835/" },
    { id: "SBUX-021", name: "å¤§ä¸¸æ¢…ç”°åº—", facility: "å¤§ä¸¸æ¢…ç”°åº—", floor: "2F", hours: "10:00ã€œ20:30", lat: 34.7016791, lng: 135.4964599, reserve: false, tea: false, power: false, night: false, new: false, work: false, scene: "è½ã¡ç€ã„ãŸä¼‘æ†©", note: "ç™¾è²¨åº—å†…ã€‚å®¢å±¤ãŒè½ã¡ç€ã„ã¦ã„ã¦ç©´å ´ã€‚", mapUrl: "https://store.starbucks.co.jp/detail-960/" },
    { id: "SBUX-022", name: "æ¢…ç”°HEP FIVE 3éšåº—", facility: "HEP FIVE", floor: "3F", hours: "11:00ã€œ21:00", lat: 34.7041119, lng: 135.5007956, reserve: false, tea: false, power: true, night: false, new: false, work: false, scene: "ãƒ‡ãƒ¼ãƒˆãƒ»ã‚·ãƒ§ãƒƒãƒ”ãƒ³ã‚°", note: "HEPå†…ã®æ¯”è¼ƒçš„æ–°ã—ã„åº—èˆ—ã€‚", mapUrl: "https://store.starbucks.co.jp/detail-4074/" },
    { id: "SBUX-023", name: "æ¢…ç”°HEP FIVE 7éšåº—", facility: "HEP FIVE", floor: "7F", hours: "11:00ã€œ21:00", lat: 34.7042, lng: 135.5007956, reserve: false, tea: false, power: true, night: false, new: false, work: false, scene: "è¦³è¦§è»Šå‰å¾Œãƒ»å¾…ã¡åˆã‚ã›", note: "è¦³è¦§è»Šè¿‘ãã€‚æ¢…ç”°ã®è€èˆ—åº—èˆ—ã€‚", mapUrl: "https://store.starbucks.co.jp/detail-28/" },
    { id: "SBUX-024", name: "ã¡ã‚ƒã‚„ã¾ã¡ã‚¢ãƒ—ãƒ­ãƒ¼ã‚ºã‚¿ãƒ¯ãƒ¼åº—", facility: "ã‚¢ãƒ—ãƒ­ãƒ¼ã‚ºã‚¿ãƒ¯ãƒ¼", floor: "1F", area: "èŒ¶å±‹ç”º", hours: "06:30ã€œ22:00", lat: 34.7083761, lng: 135.4985323, reserve: false, tea: false, power: true, night: false, new: false, work: true, scene: "æœæ´»ãƒ»ä»•äº‹ãƒ»é•·å±…", note: "æ¢…ç”°æœ€é€Ÿ6:30é–‹åº—ã€‚å¤©äº•é«˜ãé›»æºè±Šå¯Œã€‚", mapUrl: "https://store.starbucks.co.jp/detail-181/" },
    { id: "SBUX-025", name: "NUèŒ¶å±‹ç”ºãƒ—ãƒ©ã‚¹åº—", facility: "NUèŒ¶å±‹ç”ºãƒ—ãƒ©ã‚¹", floor: "1F", area: "èŒ¶å±‹ç”º", hours: "07:00ã€œ23:00", lat: 34.7074657, lng: 135.4995066, reserve: false, tea: false, power: true, night: true, new: false, work: false, scene: "å¤œã‚«ãƒ•ã‚§ãƒ»å¾…ã¡åˆã‚ã›", note: "ãƒ­ãƒ•ãƒˆæ­£é¢ã€‚å¤œ23æ™‚ã¾ã§å–¶æ¥­ã€‚é›»æºã‚ã‚Šã€‚", mapUrl: "https://store.starbucks.co.jp/detail-1019/" },
    { id: "SBUX-026", name: "TSUTAYA æ¢…ç”° MeRISEåº—", facility: "MeRISE", floor: "1F", area: "èŒ¶å±‹ç”º", hours: "10:00ã€œ18:00(å¹³æ—¥)", lat: 34.7063366, lng: 135.5010952, reserve: false, tea: false, power: true, night: false, new: false, work: true, scene: "é›†ä¸­ã—ã¦å‹‰å¼·ãƒ»ä»•äº‹", note: "å¹³æ—¥ã®ã¿å–¶æ¥­ã€‚åœ§å€’çš„ã«é™ã‹ã§é›†ä¸­ã§ãã‚‹ã€‚", mapUrl: "https://store.starbucks.co.jp/detail-2083/" },
    { id: "SBUX-027", name: "ãƒ›ãƒ¯ã‚¤ãƒ†ã‚£ã†ã‚ã åº—", facility: "ãƒ›ãƒ¯ã‚¤ãƒ†ã‚£ã†ã‚ã ", floor: "B1F", area: "æ¢…ç”°ä¸­å¿ƒ", hours: "08:00ã€œ22:00", lat: 34.7019325, lng: 135.5018079, reserve: false, tea: false, power: true, night: false, new: false, work: false, scene: "é›¨ã®æ—¥ã®å¾…ã¡åˆã‚ã›", note: "æ³‰ã®åºƒå ´è¿‘ãã€‚åœ°ä¸‹ã§æ¿¡ã‚Œãšã«ç§»å‹•å¯ã€‚", mapUrl: "https://store.starbucks.co.jp/detail-4222/" },
    { id: "SBUX-028", name: "æ¢…ç”°ã‚¨ã‚¹ãƒˆåº—", facility: "æ¢…ç”°ã‚¨ã‚¹ãƒˆ", floor: "1F", area: "æ¢…ç”°ä¸­å¿ƒ", hours: "07:00ã€œ23:00", lat: 34.7048316, lng: 135.5008364, reserve: false, tea: false, power: true, night: true, new: false, work: false, scene: "ä»•äº‹å¸°ã‚Šã®å¤œã‚«ãƒ•ã‚§", note: "ESTå†…ã€‚é§…è¿‘ã§23æ™‚ã¾ã§å–¶æ¥­ã€‚", mapUrl: "https://store.starbucks.co.jp/detail-1762/" },
    { id: "SBUX-029", name: "æ¢…ç”°ã‚¤ãƒ¼ãƒåº—", facility: "E-MA", floor: "B2F", area: "æ¢…ç”°ä¸­å¿ƒ", hours: "10:00ã€œ21:00", lat: 34.700661, lng: 135.4981396, reserve: false, tea: false, power: true, night: false, new: false, work: true, scene: "è½ã¡ç€ã„ã¦ä»•äº‹ãƒ»ç©´å ´", note: "B2Fã®é™ã‹ãªç©´å ´ã€‚ãƒãƒãƒ‰ã«æœ€é©ã€‚", mapUrl: "https://store.starbucks.co.jp/detail-4019/" },
    { id: "SBUX-030", name: "å¤§é˜ªã‚¬ãƒ¼ãƒ‡ãƒ³ã‚·ãƒ†ã‚£åº—", facility: "æ˜æ²»å®‰ç”°ç”Ÿå‘½ãƒ“ãƒ«", floor: "1F", area: "è¥¿æ¢…ç”°", hours: "07:00ã€œ22:00", lat: 34.6988943, lng: 135.4914409, reserve: false, tea: false, power: true, night: false, new: false, work: true, scene: "éš ã‚Œå®¶ãƒ»ä»•äº‹ãƒ»ãƒ‡ãƒ¼ãƒˆ", note: "æ°´ã¨ç·‘ã®ç©ºé–“ã€‚è¥¿æ¢…ç”°ã®é›»æºã‚¹ãƒãƒƒãƒˆã€‚", mapUrl: "https://store.starbucks.co.jp/detail-129/" },
    { id: "SBUX-031", name: "ä¸­ä¹‹å³¶ä¸‰äº•ãƒ“ãƒ«åº—", facility: "ä¸‰äº•ãƒ“ãƒ«", floor: "1F", area: "ä¸­ä¹‹å³¶", hours: "07:30ã€œ21:00", lat: 34.6933721, lng: 135.4941534, reserve: false, tea: false, power: true, night: false, new: false, work: true, scene: "ãƒ“ã‚¸ãƒã‚¹ãƒ»å¹³æ—¥åˆ©ç”¨", note: "ã‚ªãƒ•ã‚£ã‚¹è¡—åº—ã€‚åœŸæ—¥ç¥ä¼‘ã¿ã€‚é›»æºã‚ã‚Šã€‚", mapUrl: "https://store.starbucks.co.jp/detail-382/" },
    { id: "SBUX-032", name: "æ¡œæ©‹ãƒ—ãƒ©ã‚¶ãƒ“ãƒ«åº—", facility: "æ¡œæ©‹ãƒ—ãƒ©ã‚¶", floor: "1F", area: "ä¸­ä¹‹å³¶", hours: "07:00ã€œ21:00", lat: 34.6981551, lng: 135.4959404, reserve: false, tea: false, power: true, night: false, new: false, work: true, scene: "ãƒ“ã‚¸ãƒã‚¹ãƒ»ä»•äº‹", note: "åŒ—æ–°åœ°é§…ã™ãã€‚å¹³æ—¥ãƒ“ã‚¸ãƒã‚¹ãƒãƒ³ã«äººæ°—ã€‚", mapUrl: "https://store.starbucks.co.jp/detail-388/" },
    { id: "SBUX-033", name: "æ·€å±‹æ©‹odonaåº—", facility: "odona", floor: "B1F", area: "ä¸­ä¹‹å³¶", hours: "07:00ã€œ23:00", lat: 34.6908431, lng: 135.5004288, reserve: false, tea: false, power: true, night: true, new: false, work: true, scene: "å¤œã‚«ãƒ•ã‚§ãƒ»æ·€å±‹æ©‹ä»•äº‹", note: "é§…ç›´çµã€‚å¹³æ—¥23æ™‚ã¾ã§å–¶æ¥­ã€‚é›»æºå……å®Ÿã€‚", mapUrl: "https://store.starbucks.co.jp/detail-828/" },
    { id: "SBUX-034", name: "åŒ—æµœåº—", facility: "åŒ—æµœ", floor: "1F", area: "ä¸­ä¹‹å³¶", hours: "07:00ã€œ21:00", lat: 34.6902157, lng: 135.5063588, reserve: false, tea: false, power: true, night: false, new: true, work: false, scene: "åŒ—æµœæ•£ç­–ãƒ»æœ€æ–°åº—", note: "2024é–‹æ¥­ã®æœ€æ–°åº—èˆ—ã€‚ä¸­ä¹‹å³¶æ•£ç­–ã«ã€‚", mapUrl: "https://store.starbucks.co.jp/detail-4437/" }
];

const grid = document.getElementById('storeGrid');
const searchInput = document.getElementById('searchInput');
const resultInfo = document.getElementById('resultInfo');
const noResults = document.getElementById('noResults');

let currentArea = 'all';
let currentCategory = 'all';

// Map Setup
const map = L.map('map', { zoomControl: false }).setView([34.7024, 135.4964], 15);
L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
    attribution: 'Â© OpenStreetMap'
}).addTo(map);

// Icon Fix
delete L.Icon.Default.prototype._getIconUrl;
L.Icon.Default.mergeOptions({
    iconRetinaUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon-2x.png',
    iconUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-icon.png',
    shadowUrl: 'https://cdnjs.cloudflare.com/ajax/libs/leaflet/1.7.1/images/marker-shadow.png',
});

let activeMarkers = [];

function render() {
    const keyword = searchInput.value.toLowerCase();
    
    activeMarkers.forEach(m => map.removeLayer(m));
    activeMarkers = [];

    const filtered = stores.filter(s => {
        // å…¨æ–¹ä½æ¤œç´¢
        const searchTarget = `${s.name} ${s.facility} ${s.note} ${s.scene} ${s.area}`.toLowerCase();
        const matchKeyword = searchTarget.includes(keyword);
        
        // ã‚¨ãƒªã‚¢ãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
        const matchArea = currentArea === 'all' || s.area === currentArea;
        
        // ã‚«ãƒ†ã‚´ãƒªãƒ•ã‚£ãƒ«ã‚¿ãƒ¼
        let matchCat = true;
        if (currentCategory === 'power') matchCat = s.power;
        else if (currentCategory === 'work') matchCat = s.work;
        else if (currentCategory === 'night') matchCat = s.night;
        else if (currentCategory === 'tea') matchCat = s.tea;
        else if (currentCategory === 'reserve') matchCat = s.reserve;
        else if (currentCategory === 'new') matchCat = s.new;

        return matchKeyword && matchArea && matchCat;
    });

    resultInfo.textContent = `${filtered.length} åº—èˆ—ã‚’è¡¨ç¤ºä¸­`;
    noResults.classList.toggle('hidden', filtered.length > 0);

    grid.innerHTML = filtered.map(s => {
        const marker = L.marker([s.lat, s.lng]).addTo(map)
            .bindPopup(`<div class="text-xs font-bold">${s.name}</div><div class="text-[10px]">${s.facility}</div>`);
        activeMarkers.push(marker);

        return `
            <article class="bg-white rounded-2xl shadow-sm overflow-hidden card flex flex-col border border-gray-100">
                <div class="p-5 flex-grow">
                    <div class="flex flex-wrap gap-1 mb-2">
                        ${s.reserve ? '<span class="badge badge-reserve uppercase tracking-tighter">Reserve</span>' : ''}
                        ${s.tea ? '<span class="badge badge-tea uppercase tracking-tighter">Tea & Cafe</span>' : ''}
                        ${s.new ? '<span class="badge badge-new uppercase tracking-tighter">New</span>' : ''}
                        ${s.work ? '<span class="badge bg-indigo-50 text-indigo-700 border border-indigo-100 uppercase tracking-tighter">Work</span>' : ''}
                    </div>
                    <h3 class="text-md font-bold mb-0.5 leading-tight">${s.name}</h3>
                    <p class="text-[11px] text-green-700 font-bold mb-3 opacity-80">${s.facility} ${s.floor}</p>
                    <div class="text-[10px] text-gray-500 space-y-1.5 mb-4 leading-normal">
                        <p class="flex items-center gap-1">ğŸ•’ <span class="text-gray-700">${s.hours}</span></p>
                        <p class="flex items-start gap-1">âœ¨ <span class="text-gray-600 italic leading-relaxed">${s.note}</span></p>
                        <p class="flex items-start gap-1">ğŸ‘¥ <span class="text-gray-500">${s.scene}</span></p>
                    </div>
                    <div class="flex flex-wrap gap-2 text-[10px]">
                        ${s.power 
                            ? `<span class="bg-green-50 text-green-800 px-2.5 py-0.5 rounded border border-green-100 font-bold">ğŸ”Œ é›»æºã‚ã‚Š</span>` 
                            : '<span class="bg-gray-50 text-gray-400 px-2.5 py-0.5 rounded border border-gray-100 italic">ğŸ”Œ é›»æºãªã—</span>'}
                        ${s.night ? '<span class="bg-orange-50 text-orange-700 px-2.5 py-0.5 rounded border border-orange-100 font-bold">ğŸŒ™ 23æ™‚è¿„</span>' : ''}
                    </div>
                </div>
                <div class="grid grid-cols-2 border-t text-center text-[11px] font-bold bg-gray-50">
                    <a href="${s.mapUrl}" target="_blank" class="py-3.5 text-gray-600 border-r hover:bg-white transition active:bg-gray-200">å…¬å¼ã‚µã‚¤ãƒˆ</a>
                    <button onclick="zoomTo(${activeMarkers.length - 1}, ${s.lat}, ${s.lng})" class="py-3.5 text-blue-600 hover:bg-white transition active:bg-blue-100">åœ°å›³ã§è¦‹ã‚‹</button>
                </div>
            </article>
        `;
    }).join('');
}

function zoomTo(idx, lat, lng) {
    map.setView([lat, lng], 18);
    activeMarkers[idx].openPopup();
    window.scrollTo({ top: 0, behavior: 'smooth' });
}

function resetFilters() {
    searchInput.value = '';
    currentArea = 'all';
    currentCategory = 'all';
    updateButtons();
    render();
}

function updateButtons() {
    document.querySelectorAll('.filter-btn, .cat-btn').forEach(btn => {
        const isActive = (btn.dataset.area === currentArea) || (btn.dataset.cat === currentCategory);
        btn.classList.toggle('btn-active', isActive);
    });
}

// Events
document.querySelectorAll('.filter-btn').forEach(btn => {
    btn.onclick = () => {
        currentArea = btn.dataset.area;
        updateButtons();
        render();
    };
});

document.querySelectorAll('.cat-btn').forEach(btn => {
    btn.onclick = () => {
        currentCategory = btn.dataset.cat;
        updateButtons();
        render();
    };
});

searchInput.oninput = render;
updateButtons();
render();
</script>
</body>
</html>
